document.addEventListener('DOMContentLoaded', function () {
    // Accordion functionality
    const accordions = document.querySelectorAll('.accordion-toggle');
    accordions.forEach(button => {
        button.addEventListener('click', () => {
            const content = button.nextElementSibling;
            content.classList.toggle('open');
            button.querySelector('svg').classList.toggle('rotate-180');
        });
    });

    // Functions to create dynamic blocks (skills, experience, projects, etc.)
    const createRemoveButton = () => `<button class="remove-btn absolute top-2 right-2 text-red-500 hover:text-red-700 text-2xl font-bold">&times;</button>`;

    function createSkillBlock(placeholder) {
        const div = document.createElement('div');
        div.className = 'flex items-center gap-2 mb-2 relative';
        div.innerHTML = `<input type="text" placeholder="${placeholder}" class="p-2 border rounded-md w-full" data-type="skill">${createRemoveButton()}`;
        return div;
    }

    function createExperienceBlock() {
        const div = document.createElement('div');
        div.className = 'p-4 border rounded-md mb-4 relative';
        div.innerHTML = `
            <input type="text" placeholder="Job Title" class="p-2 border rounded-md w-full mb-2 font-semibold" data-type="job-title">
            <input type="text" placeholder="Company, Location" class="p-2 border rounded-md w-full mb-2" data-type="company">
            <div class="grid grid-cols-2 gap-2 mb-2">
                <input type="text" placeholder="Start Date (e.g., Jan 2024)" class="p-2 border rounded-md w-full" data-type="start-date">
                <input type="text" placeholder="End Date (e.g., Present)" class="p-2 border rounded-md w-full" data-type="end-date">
            </div>
            <textarea placeholder="Description (use '*' for bullet points)" class="p-2 border rounded-md w-full h-24" data-type="description"></textarea>
            ${createRemoveButton()}
        `;
        return div;
    }

    // Add initial skill/experience blocks if needed
    // document.getElementById('professional-skills-list').appendChild(createSkillBlock('Prototyping Tools'));

    // PDF download functionality
    document.getElementById('download-pdf').addEventListener('click', () => {
        const previewElement = document.getElementById('cv-preview');
        const fullName = document.getElementById('full-name').value || 'CV';
        const opt = {
            margin: 0,
            filename: `${fullName.replace(/\s+/g, '_')}_CV.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 3, useCORS: true, letterRendering: true },
            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
        };
        html2pdf().from(previewElement).set(opt).save();
    });
});
